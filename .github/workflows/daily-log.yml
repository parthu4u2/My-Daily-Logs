name: Daily Log Creator

on:
  schedule:
    - cron: '0 5 * * *'  # Runs daily at 10:30 AM IST (5:00 AM UTC)
  workflow_dispatch:     # Allows manual run

jobs:
  create-log:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Set date environment variables
      run: |
        echo "DATE=$(date +'%Y-%m-%d')" >> $GITHUB_ENV
        echo "PRETTY_DATE=$(date +'%d %B %Y')" >> $GITHUB_ENV
        echo "WEEKDAY=$(date +'%A')" >> $GITHUB_ENV

    - name: Generate daily log
      run: |
        FILE_NAME="${{ env.DATE }}.md"

        tips=("Use sliding window for substrings." "Binary search works even in rotated arrays." "Prefix sums simplify range-based queries." "Two-pointer method is best for sorted arrays." "Dry-run test cases on paper first.")
        questions=("What made you feel proud today?" "What challenge did you overcome?" "What are you grateful for today?" "Did you learn something new?" "How did you push yourself today?")
        quotes=("Push yourself, because no one else will." "Consistency beats talent." "You don’t need to be perfect, just better than yesterday." "Big journeys begin with small steps." "Winners were once beginners who didn’t quit.")

        RANDOM_TIP=${tips[$RANDOM % ${#tips[@]}]}
        RANDOM_Q=${questions[$RANDOM % ${#questions[@]}]}
        RANDOM_QUOTE=${quotes[$RANDOM % ${#quotes[@]}]}

        echo "# 📅 ${{ env.PRETTY_DATE }} (${{ env.WEEKDAY }})" > "$FILE_NAME"
        echo "" >> "$FILE_NAME"
        echo "- [ ] 🏋️ **Exercise**" >> "$FILE_NAME"
        echo "- [ ] 📘 **DSA Learning**" >> "$FILE_NAME"
        echo "" >> "$FILE_NAME"
        echo "📝 **Notes**: " >> "$FILE_NAME"
        echo "" >> "$FILE_NAME"
        echo "🎯 **Productivity Score**: ___ / 10" >> "$FILE_NAME"
        echo "⭐ **Day Rating**: [ ]★ [ ]★★ [ ]★★★ [ ]★★★★ [ ]★★★★★" >> "$FILE_NAME"
        echo "" >> "$FILE_NAME"
        echo "💡 **DSA Tip**: $RANDOM_TIP" >> "$FILE_NAME"
        echo "" >> "$FILE_NAME"
        echo "🤔 **Reflection**: $RANDOM_Q" >> "$FILE_NAME"
        echo "" >> "$FILE_NAME"
        echo "🌟 *$RANDOM_QUOTE*" >> "$FILE_NAME"
        echo "" >> "$FILE_NAME"
        echo "📸 **Code Screenshot** (if any):" >> "$FILE_NAME"
        echo "![Upload here](images/${{ env.DATE }}.png)" >> "$FILE_NAME"

    - name: Commit and push
      run: |
        git config user.name github-actions
        git config user.email github-actions@github.com
        git add .
        git commit -m "📄 Daily log for ${{ env.DATE }}" || echo "No changes to commit"
        git push
